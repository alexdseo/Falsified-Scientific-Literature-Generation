# Discrimination

This folder contains code for the discrimination experiments.

`run_discrimination.py` can be used to train or evaluate a model for discrimination

## Discrimination checkpoints
Here are links to the discrimination checkpoints. You'll need to use google cloud storage to download these.

**NOTE**: These checkpoints were trained on 5000 examples from a specific Grover generator, with a specific nucleus sampling top-p setting. As a result, these aren't necessarily the best discrimination checkpoints, nor are they the most general. The reason we used this experimental setup is outlined [in the paper](https://arxiv.org/abs/1905.12616) -- we assumed limited access to the generator. We did [later experiments](https://medium.com/ai2-blog/counteracting-neural-disinformation-with-grover-6cf6690d463b) and found that if you assume, say, 100k examples from a generator, you'll do much better (up to around 97% accuracy).

In other words, if you want to mimic my experimental setup, but with your own generator, you'd also need to train your own discriminator from scratch. Alternatively, if you want a really good discriminator against my checkpoints for whatever reason, you'd also probably want to train your own discriminator from scratch.

**For the experiments in this repository, find the pretrained model checkpoints at [this folder](https://github.com/alexdseo/Falsified-Scientific-Literature-Generation/tree/master/pretrained_model)**

Medium trained on medium, top-p=0.96:
```
gs://grover-models/discrimination/generator=medium~discriminator=grover~discsize=medium~dataset=p=0.96/model.ckpt-1562.data-00000-of-00001
gs://grover-models/discrimination/generator=medium~discriminator=grover~discsize=medium~dataset=p=0.96/model.ckpt-1562.index
gs://grover-models/discrimination/generator=medium~discriminator=grover~discsize=medium~dataset=p=0.96/model.ckpt-1562.meta
```

Mega trained on mega, top-p=0.94:
```
gs://grover-models/discrimination/generator=mega~discriminator=grover~discsize=mega~dataset=p=0.94/model.ckpt-1562.data-00000-of-00001
gs://grover-models/discrimination/generator=mega~discriminator=grover~discsize=mega~dataset=p=0.94/model.ckpt-1562.index
gs://grover-models/discrimination/generator=mega~discriminator=grover~discsize=mega~dataset=p=0.94/model.ckpt-1562.meta
```
## Experiment

The .npy files are the result from our experiment using Bik.tsv dataset. All experiment code is demonstrated at `grover_test_bik.ipynb`. For Discrimination experiment, we used the above pretrained checkpoints with top-p=0.96. The input file for the discrimination experiment needs to be preprocess and these input files can be found on the [fake_text folder](https://github.com/alexdseo/Falsified-Scientific-Literature-Generation/tree/master/fake_text) with `*_disc.jsonl`.

- `human_test-probs.npy` are the result using the human written papers with media manipulation that were provided by Bik et al.
- `machine_test-probs.npy` are the result using first 214 fake text generated by Grover.
- `machine2_test-probs.npy` are the result using next 214 fake text generated by Grover.
- `machine3_test-probs.npy` are the result using last 72 fake text generated by Grover.

We only took the first column of these .npy files which is the probability the text is written by machine while the second is probability it is written by human. You can see details in `get_probs.ipynb`.
